
# 스토리북 작성을 통해 얻게 되는 리팩토링 효과
- https://fe-developers.kakaoent.com/2022/220609-storybookwise-component-refactoring/?fbclid=IwAR12fQ5xkvONspvkekq7D0TTNODneeRE5eznzULog5a_Qodpf_Ph3Nbm-mA

## 스토리북
- UI 컴포넌트를 독립적인 환경에서 그려볼 수 있는 툴 중 하나
- 코드리뷰, 타개발자, 디자이너에게 쉽게 확인할수 있게 UI 컴포넌트의 미리보기 기능을 제공
- 1) 독립적인 환경, 2) 재사용

## 리팩토링 방법 경험 공유
과로: 하나의 컴포넌트에서 너무 많은 일을 하는 경우
- 처음 기존에 있던 컴포넌트를 스토리북에 적용하면 라우팅 처리, 상태 관리, 로깅 데이터 전송 등 사이드 이펙트를 일으키는 요소에 의해 에러가 뜨고 그릴수 없습니다.
- Presentational, View 요소 구분하여 독립적인 컴포넌트 분리
- 아토믹 디자인 참고하여 컴포넌트 분리

데이터를 불필요하게 불러오는 경우
- 스토리북에 적용함으로서 컴포넌트에서 꼭 데이터를 불러와야 하는지 재검토해보는 계기
- 데이터를 불러오는 의존성이 내부에 캡슐화되어 있다가 외부에서 주입할 수 있는 형태로 변경하고 해당 컴포넌트는 이제 데이터를 불러오는 것에 대한 관심은 사라졌고, 오로지 주어진 값으로부터 적절히 그리는 역할만 잘 수행하면 됩니다.(Presentation)

발작 증세: 간혹 그려져서는 안 되는 결과물로 그려지는 경우
- variation이 많도록 설계가 되면 발작 증세가 쉽게 발현될 수 있습니다. 컴포넌트의 렌더링되는 경우의 수가 많으면 유연성이 높아집니다. 따라서 재사용을 할 수 있는 범위가 늘어난다는 장점이 있습니다. 하지만 재사용을 잘못하면 결함으로 여겨질 정도로 잘못된 결과물을 그리게 될 수도 있습니다. ex) publishedDate string props로 받았을 경우 다양한 문자열이 와서 의도하지 않는 결과가 발생할 수 있다.

### 그외 컴포넌트의 **유연성**을 확장하는 패턴

1. 대표적인 예시는 요소의 스타일을 외부에서 주입하는 방법입니다. classes라는 하나의 props에 tailwind의 클래스로 스타일을 주입하는 경우
2. 또 다른 방법은 Compound Pattern 으로 작성하여 조합하는 방법

## 피터팬 증후군: 독립해서 그려보니 의도와 다르게 그려지는 경우
- 컴포넌트가 다른 컴포넌트에 의존성을 가진 경우


예시 1. 부모의 스타일에 의존하는 경우
- 이런 경우는 position: relative; 속성이 있는 부모 요소까지 함께 컴포넌트에 포함하면 환경과 관계없이 항상 예상된 결과물을 그릴 수 있습니다.

예시 2. 특정 문맥에 위치해야만 자연스러운 경우
-  layout (여백)에 대한 책임을 분리하면 다른 layout에도 충분히 재사용을 할 수 있게 됩니다.

예시 3. 부모나 전역 환경에 항상 존재할 것이라고 가정하고 참조하는 경우
-  부모나 전역 환경에 의존성이 있는 부분을 컴포넌트와 분리하면 스토리북으로 옮기는게 가능해집니다

### QA
- 유연성을 확장하는 패턴은 어느 경우에 적용하는것이 좋을까
  - https://www.patterns.dev/posts/compound-pattern/
- 데이터를 불러오는 파트를 분리했을 경우 Fetcher, Suspense Loader는 어느 패키지에 분리해두는것이 바람직한가
  - [아토믹 디자인](https://fe-developers.kakaoent.com/2022/220505-how-page-part-use-atomic-design-system/)을 참고하여 컴포넌트를 분리하고 배치 부분을 참조하여보면 답이 나올듯하다.
    - 구조를 나누는것에 포커스 되어있어 데이터 불러오는 파트에 대한 언급은 따로 있진 않음.
    - 다만 remix, 향후 react18 context기준으로 보았을때 nested routes, routes단에 두는것이 적합하다 판단.
